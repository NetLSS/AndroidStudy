# ì•ˆë“œë¡œì´ë“œ ì•Œë¦¼ ê°œìš”
 
> ë³¸ íŽ˜ì´ì§€ëŠ” ì €ì˜ [ì•Œë¦¼ì•± ë°ëª¨ ë ˆíŒŒì§€í† ë¦¬](https://github.com/NetLSS/LocalNotifyDemo)ì™€ ì—°ê²°ë©ë‹ˆë‹¤.

- ì•Œë¦¼ : ì•±ì´ ì‹¤í–‰ë˜ê³  ìžˆì§€ ì•Šê±°ë‚˜, ë°±ê·¸ë¼ìš´ë“œ ìƒíƒœì¼ ë•Œ ì‚¬ìš©ìžì—ê²Œ ë©”ì„¸ì§€ë¥¼ ì „ë‹¬í•˜ëŠ” ë°©ë²•
- ë¡œì»¬ ì•Œë¦¼ê³¼ ì›ê²© ì•Œë¦¼ì´ ìžˆìŒ
  - ë¡œì»¬ ì•Œë¦¼: ìž¥ì¹˜ì—ì„œ ì‹¤í–‰ì¤‘ì¸ ì•±ì—ì„œ ìƒì„±ë˜ëŠ” ì•Œë¦¼
  - ì›ê²© ì•Œë¦¼: ì›ê²© ì„œë²„ì—ì„œ ìƒì„œë˜ì–´ ìž¥ì¹˜ì— ì „ì†¡ë˜ëŠ” ì•Œë¦¼
- ê° ì•Œë¦¼ì€ ë²„íŠ¼ ê°™ì€ ê²ƒì„ í¬í•¨í•  ìˆ˜ ìžˆì–´ì„œ ì•Œë¦¼ì„ ë³´ë‚¸ ì•±ì„ ì‹¤í–‰í•  ìˆ˜ ìžˆë‹¤.
- ë˜ ì•ˆë“œë¡œì´ë“œì—ì„œëŠ” **ì§ì ‘ ì‘ë‹µ ì•Œë¦¼**ì„ ì§€ì›í•˜ì—¬. ì‚¬ìš©ìžê°€ ë°”ë¡œ ì•Œë¦¼ì— ëŒ€í•œ ì‘ë‹µì„ ë°”ë¡œ ë³´ë‚¼ ìˆ˜ ìžˆê²Œ í•œë‹¤.

## ì•Œë¦¼ ê°œìš”

- ì•ˆë“œë¡œì´ë“œ 8ì´ìƒ ë²„ì „ ë¶€í„°ëŠ” ì•± ë¡ ì²˜ ì•„ì´ì½˜ì„ ê¸¸ê²Œ ëˆŒëŸ¬ ì•±ê³¼ ê´€ë ¨ëœ ì•Œë¦¼ì„ ëª¨ë‘ ë³¼ ìˆ˜ ìžˆë‹¤.
- ì•ˆë“œë¡œì´ë“œ 8ì´ìƒ ë²„ì „ ë¶€í„°ëŠ” ì‚¬ìš©ìžê°€ ë¯¸í™•ì¸í•œ ì•Œë¦¼ì´ ìžˆì„ ë•Œ ì•„ì´ì½˜ì— ì ìœ¼ë¡œ ë‚˜íƒ€ë‚´ëŠ” ì•Œë¦¼ ë„íŠ¸ë¥¼ ì§€ì›í•œë‹¤.
- ì•Œë¦¼ì„ íƒ­í•˜ë©´ ë³´í†µ í•´ë‹¹ ë©”ì„¸ì§€ë¥¼ ëª¨ë‚¸ ì•Œë¦¼ì„ ì‹¤í–‰
- ë˜í•œ ì•Œë¦¼ì—ëŠ” ì•¡ì…˜ ë²„íŠ¼ì´ í¬í•¨ë  ìˆ˜ ìžˆì–´ íŠ¹ì • ìž‘ì—… ìˆ˜í–‰ì´ ê°€ëŠ¥
- ë˜ ì‚¬ìš©ìžê°€ ì§ì ‘ ì•Œë¦¼ì— ëŒ€í•œ í…ìŠ¤íŠ¸ ì‘ë‹µì„ ë³´ë‚¼ ìˆ˜ë„ ìžˆìŒ. (ì•± í¬ê·¸ë¼ìš´ë“œ ì‹¤í–‰í•„ìš” ì—†ì´ ì•ŒëžŒ ì‘ë‹µê°€ëŠ¥)

## ì•Œë¦¼ ì±„ë„ ìƒì„±í•˜ê¸°

- ì•±ì—ì„œ ì•Œë¦¼ì„ ì „ì†¡í•˜ê¸° ìœ„í•´ ì•Œë¦¼ ì±„ë„ ìƒì„± í•„ìš”
- ì•±ì—ì„œ ì±„ë„ì„ ê³ ìœ ížˆ ì‹ë³„í•˜ëŠ” ID, ì±„ë„ ì´ë¦„, ì±„ë„ ì„¤ëª…ìœ¼ë¡œ êµ¬ì„±
- ì‚¬ìš©ìžëŠ” ì±„ë„ ì´ë¦„ ë° ì„¤ëª…ì„ í™•ì¸í•  ìˆ˜ ìžˆìŒ
1. `NotificationChannel` ì¸ìŠ¤í„´ìŠ¤ë¥¼ êµ¬ì„±
2. í•´ë‹¹ ì¸ìŠ¤í„´ìŠ¤ë¥¼ `NotificationManager` í´ëž˜ìŠ¤ì˜ `createNotificationChannel()` í•¨ìˆ˜ì— ì „ë‹¬

```kotlin
import android.app.NotificationChannel
import android.app.NotificationManager
import android.content.ClipDescription
import android.content.Context
import android.graphics.Color
import android.os.Build
import androidx.appcompat.app.AppCompatActivity
import android.os.Bundle
import androidx.annotation.RequiresApi

class MainActivity : AppCompatActivity() {

    private var notificationManager: NotificationManager? = null

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        notificationManager = getSystemService(Context.NOTIFICATION_SERVICE) as NotificationManager

        
    }

    @RequiresApi(Build.VERSION_CODES.O)
    private fun createNotificationChannel(id: String, name: String, description: String) {
        val importance = NotificationManager.IMPORTANCE_LOW
        val channel = NotificationChannel(id, name, importance)
        
        channel.apply { 
            this.description = description
            enableLights(true)
            lightColor = Color.RED
            enableVibration(true)
            channel.vibrationPattern = longArrayOf(100, 200, 300, 400, 500, 400, 300, 200, 400)
        }
        
        notificationManager?.createNotificationChannel(channel)
    }
}
```

- ì±„ë„ ì‚­ì œ

```kotlin
        val channelID = "com.lilcode.examples.notifydemo.news"
        notificationManager?.deleteNotificationChannel(channelID)
```

- ì•Œë¦¼ ìƒì„± ë° ì „ë‹¬

```kotlin
    @RequiresApi(Build.VERSION_CODES.O)
    fun sendNotification(view: View) {
        // ì•Œë¦¼ ìƒì„±
        val notification = Notification.Builder(this@MainActivity, newsChannelID)
            .setContentTitle("Example Notification")
            .setContentTitle("This is an example notification.")
            .setSmallIcon(android.R.drawable.ic_dialog_info)
            .setChannelId(newsChannelID)
            .setNumber(999)
            .build()

        val notificationID = 101 // ì •ìˆ˜ê°’ ì•„ë¬´ê±°ë‚˜ (í–¥í›„ ì•Œë¦¼ ë³€ê²½ì‹œ ì‚¬ìš©ë¨)

        notificationManager?.notify(notificationID, notification)
    }

    companion object {
        const val newsChannelID = "com.lilcode.example.localnotifydemo"
    }
```

- ê° ì•Œë¦¼ì— ëŒ€í•œ ì‹¤í–‰ ì‹œ ì–´ë–»ê²Œ í•´ë‹¹ ì•Œë¦¼ìœ¼ë¡œ ì‹¤í–‰í–ˆëŠ”ì§€ ì•Œìˆ˜ ìžˆê² ë‚˜
  - ì´ê±´ í•´ë‹¹ ì•Œë¦¼ì— ëŒ€í•œ íŒ¬ë”©ì¸í…íŠ¸ì— ì •ë³´ë¥¼ ë„£ë˜ì§€ ë˜ëŠ” ì‹¤í–‰í•´ì•¼í•  ì•¡í‹°ë¹„í‹°ë¥¼ íŒ¬ë”©ì¸í…íŠ¸ì— ë‹´ì•„ ì „ë‹¬í•´ì„œ í™•ì¸í•  ìˆ˜ ìžˆì„ë“¯í•˜ë‹¤.


- ì•Œë¦¼ìœ¼ë¡œ ë¶€í„° ì•¡í‹°ë¹„í‹° ì‹¤í–‰ ì‹œí‚¤ê¸°

```kotlin
    fun sendNotification(view: View) {

        val resultIntent = Intent(this, ResultActivity::class.java) // ðŸ‘ˆ

        val pendingIntent = PendingIntent.getActivity(this, 0, resultIntent, PendingIntent.FLAG_UPDATE_CURRENT) // ðŸ‘ˆ
        // PendingIntent.FLAG_UPDATE_CURRENT : íŒ¬ë”© ì¸í…íŠ¸ê°€ ì´ë¯¸ ì¡´ìž¬í• ê²½ìš°, Extra dataë¥¼ ìƒˆë¡œìš´ ì¸í…íŠ¸ ë°ì´í„°ë¡œ ì—…ë°ì´íŠ¸
        // ê°ê°ì˜ ì•Œë¦¼ì—ì„œëŠ” íŒ¬ë”©ì¸í…íŠ¸ê°€ ë™ì¼ í•˜ë„ë¡

        // ì•Œë¦¼ ìƒì„±
        val notification = Notification.Builder(this@MainActivity, newsChannelID)
            .setContentTitle("Example Notification")
            .setContentTitle("This is an example notification.")
            .setSmallIcon(android.R.drawable.ic_dialog_info)
            .setChannelId(newsChannelID)
            .setNumber(999)
            .setContentIntent(pendingIntent) // ðŸ‘ˆ
            .build()

        val notificationID = 101 // ì •ìˆ˜ê°’ ì•„ë¬´ê±°ë‚˜ (í–¥í›„ ì•Œë¦¼ ë³€ê²½ì‹œ ì‚¬ìš©ë¨)

        notificationManager?.notify(notificationID, notification)
    }
```

- ì•Œë¦¼ì— ì•¡ì…˜ ì¶”ê°€í•˜ê¸°

```kotlin
package com.lilcode.example.localnotifydemo

import android.app.Notification
import android.app.NotificationChannel
import android.app.NotificationManager
import android.app.PendingIntent
import android.content.ClipDescription
import android.content.Context
import android.content.Intent
import android.graphics.Color
import android.graphics.drawable.Icon
import android.os.Build
import androidx.appcompat.app.AppCompatActivity
import android.os.Bundle
import android.view.View
import androidx.annotation.RequiresApi

class MainActivity : AppCompatActivity() {

    private var notificationManager: NotificationManager? = null

    @RequiresApi(Build.VERSION_CODES.O)
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        notificationManager = getSystemService(Context.NOTIFICATION_SERVICE) as NotificationManager

        createNotificationChannel(
            newsChannelID,
            "Notify News",
            "Example news Channel"
        )
    }

    @RequiresApi(Build.VERSION_CODES.O)
    private fun createNotificationChannel(id: String, name: String, description: String) {
        val importance = NotificationManager.IMPORTANCE_LOW
        // ì±„ë„ ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ë° ì´ˆê¸°í™”
        val channel = NotificationChannel(id, name, importance).apply {
            this.description = description
            enableLights(true)
            lightColor = Color.RED
            enableVibration(true)
            vibrationPattern = longArrayOf(100, 200, 300, 400, 500, 400, 300, 200, 400)
        }

        notificationManager?.createNotificationChannel(channel)
    }

    @RequiresApi(Build.VERSION_CODES.O)
    fun sendNotification(view: View) {

        val resultIntent = Intent(this, ResultActivity::class.java)
        val pendingIntent = PendingIntent.getActivity(this, 0, resultIntent, PendingIntent.FLAG_UPDATE_CURRENT)
        // PendingIntent.FLAG_UPDATE_CURRENT : íŒ¬ë”© ì¸í…íŠ¸ê°€ ì´ë¯¸ ì¡´ìž¬í• ê²½ìš°, Extra dataë¥¼ ìƒˆë¡œìš´ ì¸í…íŠ¸ ë°ì´í„°ë¡œ ì—…ë°ì´íŠ¸
        // ê°ê°ì˜ ì•Œë¦¼ì—ì„œëŠ” íŒ¬ë”©ì¸í…íŠ¸ê°€ ë™ì¼ í•˜ë„ë¡

        val icon: Icon = Icon.createWithResource(this, android.R.drawable.ic_dialog_info) // ðŸ‘ˆ
        val action: Notification.Action = Notification.Action.Builder(icon, "Open", pendingIntent).build() // ðŸ‘ˆ

        // ì•Œë¦¼ ìƒì„±
        val notification = Notification.Builder(this@MainActivity, newsChannelID)
            .setContentTitle("Example Notification")
            .setContentTitle("This is an example notification.")
            .setSmallIcon(android.R.drawable.ic_dialog_info)
            .setChannelId(newsChannelID)
            .setNumber(999)
            .setContentIntent(pendingIntent)
            .setActions(action) // ðŸ‘ˆ
            .build()

        val notificationID = 101 // ì •ìˆ˜ê°’ ì•„ë¬´ê±°ë‚˜ (í–¥í›„ ì•Œë¦¼ ë³€ê²½ì‹œ ì‚¬ìš©ë¨)

        notificationManager?.notify(notificationID, notification)
    }

    companion object {
        const val newsChannelID = "com.lilcode.example.localnotifydemo"
    }
}
```

---

### ì•Œë¦¼ ì±„ë„ ì„¤ì •í•˜ê¸° ex2

```kotlin
package com.lilcode.example.directreplynotifydemo

import android.app.NotificationChannel
import android.app.NotificationManager
import android.content.Context
import android.graphics.Color
import android.os.Build
import androidx.appcompat.app.AppCompatActivity
import android.os.Bundle
import androidx.annotation.RequiresApi
import com.lilcode.example.directreplynotifydemo.databinding.ActivityMainBinding

class MainActivity : AppCompatActivity() {

    private var _binding: ActivityMainBinding? = null
    private val binding get() = requireNotNull(_binding)

    private var notificationManager: NotificationManager? = null
    private val channelID = "com.lilcode.example.directreplynotifydemo.news"

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        _binding = ActivityMainBinding.inflate(layoutInflater)
        setContentView(binding.root)

        notificationManager = getSystemService(Context.NOTIFICATION_SERVICE) as? NotificationManager

        createNotificationChannel(channelID, "DirectReply News", "Example News Channel")
    }

    private fun createNotificationChannel(id: String, name: String, description: String) {
        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {
            val importance = NotificationManager.IMPORTANCE_HIGH
            NotificationChannel(id, name, importance).apply {
                this.description = description
                enableLights(true)
                lightColor = Color.RED
                enableVibration(true)
                vibrationPattern = longArrayOf(100, 200, 300, 400, 500, 400, 300, 200, 400)
                notificationManager?.createNotificationChannel(this)
            }
        }

    }
}
```